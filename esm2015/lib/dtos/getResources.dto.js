import { __awaiter, __decorate } from "tslib";
import { Type } from 'class-transformer';
import { IsArray, IsIn, IsNumber, IsOptional, IsString, Matches, ValidateNested, validateOrReject, } from 'class-validator';
export class Query {
    constructor(select, from, where, orderBy) {
        this.select = select;
        this.from = from;
        this.where = where;
        this.orderBy = orderBy;
    }
    getCountSql() {
        let sql = `SELECT COUNT(*) AS value FROM ${this.from} `;
        if (this.where)
            sql += `WHERE ${this.where} `;
        return sql;
    }
    getSql(limit, page) {
        const skip = (page - 1) * limit;
        let sql = `SELECT ${this.select} FROM ${this.from} `;
        if (this.where)
            sql += `WHERE ${this.where} `;
        if (this.orderBy)
            sql += `ORDER BY ${this.orderBy} `;
        sql += `LIMIT ${skip}, ${limit}`;
        return sql;
    }
}
__decorate([
    IsString(),
    IsOptional()
], Query.prototype, "select", void 0);
__decorate([
    IsString(),
    IsOptional()
], Query.prototype, "from", void 0);
__decorate([
    IsString(),
    IsOptional()
], Query.prototype, "where", void 0);
__decorate([
    IsString(),
    IsOptional()
], Query.prototype, "orderBy", void 0);
export class Filter {
    constructor(field, operator, value) {
        this.field = field;
        this.operator = operator;
        this.value = value;
    }
}
__decorate([
    IsString()
], Filter.prototype, "field", void 0);
__decorate([
    IsString(),
    IsIn(['IN', 'LIKE', '=', '>=', '<=', 'NOT LIKE', '!='])
], Filter.prototype, "operator", void 0);
export class GetResourcesDto {
    constructor() {
        this.filters = [];
        this.limit = 10;
        this.page = 1;
    }
    toParamsDict() {
        const dict = {};
        if (this.fields)
            dict['fields'] = JSON.stringify(this.fields);
        if (this.sort)
            dict['sort'] = JSON.stringify(this.sort);
        if (this.filters)
            dict['filters'] = JSON.stringify(this.filters);
        if (this.sort)
            dict['sort'] = JSON.stringify(this.sort);
        if (this.page)
            dict['page'] = JSON.stringify(this.page);
        if (this.query)
            dict['query'] = JSON.stringify(this.query);
        if (this.limit)
            dict['limit'] = JSON.stringify(this.limit);
        return dict;
    }
    fromParamsDict(params) {
        const { fields, sort, filters, limit, page, query } = params;
        if (fields)
            this.fields = JSON.parse(fields);
        if (sort)
            this.sort = JSON.parse(sort);
        if (filters)
            this.filters = JSON.parse(filters);
        if (limit)
            this.limit = JSON.parse(limit);
        if (page)
            this.page = JSON.parse(page);
        if (query) {
            const queryDict = JSON.parse(query);
            this.query = new Query(queryDict.select, queryDict.from, queryDict.where, queryDict.orderBy);
        }
    }
    validate() {
        return __awaiter(this, void 0, void 0, function* () {
            try {
                yield validateOrReject(this);
                return true;
            }
            catch (errors) {
                console.log('Dto Validation Failed. Errors: ', errors);
                return false;
            }
        });
    }
}
__decorate([
    IsArray(),
    IsOptional()
], GetResourcesDto.prototype, "fields", void 0);
__decorate([
    IsString(),
    IsOptional(),
    Matches(/^[+-].*/, {
        message: "sort must start with '+' or '-'",
        each: true,
    })
], GetResourcesDto.prototype, "sort", void 0);
__decorate([
    IsArray(),
    IsOptional(),
    ValidateNested(),
    Type(() => Filter)
], GetResourcesDto.prototype, "filters", void 0);
__decorate([
    IsNumber(),
    IsOptional()
], GetResourcesDto.prototype, "limit", void 0);
__decorate([
    IsNumber(),
    IsOptional()
], GetResourcesDto.prototype, "page", void 0);
__decorate([
    IsOptional(),
    ValidateNested(),
    Type(() => Query)
], GetResourcesDto.prototype, "query", void 0);
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZ2V0UmVzb3VyY2VzLmR0by5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uLy4uL3Byb2plY3RzL3RzeC1maXRlbG8vc3JjL2xpYi9kdG9zL2dldFJlc291cmNlcy5kdG8udHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IjtBQUFBLE9BQU8sRUFBRSxJQUFJLEVBQUUsTUFBTSxtQkFBbUIsQ0FBQztBQUN6QyxPQUFPLEVBQ0wsT0FBTyxFQUNQLElBQUksRUFDSixRQUFRLEVBQ1IsVUFBVSxFQUNWLFFBQVEsRUFDUixPQUFPLEVBQ1AsY0FBYyxFQUNkLGdCQUFnQixHQUNqQixNQUFNLGlCQUFpQixDQUFDO0FBRXpCLE1BQU0sT0FBTyxLQUFLO0lBaUJoQixZQUFZLE1BQWMsRUFBRSxJQUFZLEVBQUUsS0FBYyxFQUFFLE9BQWdCO1FBQ3hFLElBQUksQ0FBQyxNQUFNLEdBQUcsTUFBTSxDQUFDO1FBQ3JCLElBQUksQ0FBQyxJQUFJLEdBQUcsSUFBSSxDQUFDO1FBQ2pCLElBQUksQ0FBQyxLQUFLLEdBQUcsS0FBSyxDQUFDO1FBQ25CLElBQUksQ0FBQyxPQUFPLEdBQUcsT0FBTyxDQUFDO0lBQ3pCLENBQUM7SUFFRCxXQUFXO1FBQ1QsSUFBSSxHQUFHLEdBQUcsaUNBQWlDLElBQUksQ0FBQyxJQUFJLEdBQUcsQ0FBQztRQUN4RCxJQUFJLElBQUksQ0FBQyxLQUFLO1lBQUUsR0FBRyxJQUFJLFNBQVMsSUFBSSxDQUFDLEtBQUssR0FBRyxDQUFDO1FBQzlDLE9BQU8sR0FBRyxDQUFDO0lBQ2IsQ0FBQztJQUVELE1BQU0sQ0FBQyxLQUFhLEVBQUUsSUFBWTtRQUNoQyxNQUFNLElBQUksR0FBRyxDQUFDLElBQUksR0FBRyxDQUFDLENBQUMsR0FBRyxLQUFLLENBQUM7UUFDaEMsSUFBSSxHQUFHLEdBQUcsVUFBVSxJQUFJLENBQUMsTUFBTSxTQUFTLElBQUksQ0FBQyxJQUFJLEdBQUcsQ0FBQztRQUNyRCxJQUFJLElBQUksQ0FBQyxLQUFLO1lB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O0lBSkMsT0FBTyxFQUFFO0lBQ1QsVUFBVSxFQUFFO0lBQ1osY0FBYyxFQUFFO0lBQ2hCLElBQUksQ0FBQyxHQUFHLEVBQUUsQ0FBQyxNQUFNLENBQUM7Z0RBQ0E7QUFJbkI7SUFGQyxRQUFRLEVBQUU7SUFDVixVQUFVLEVBQUU7OENBQ0U7QUFJZjtJQUZDLFFBQVEsRUFBRTtJQUNWLFVBQVUsRUFBRTs2Q0FDQztBQUtkO0lBSEMsVUFBVSxFQUFFO0lBQ1osY0FBYyxFQUFFO0lBQ2hCLElBQUksQ0FBQyxHQUFHLEVBQUUsQ0FBQyxLQUFLLENBQUM7OENBQ0oiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBUeXBlIH0gZnJvbSAnY2xhc3MtdHJhbnNmb3JtZXInO1xuaW1wb3J0IHtcbiAgSXNBcnJheSxcbiAgSXNJbixcbiAgSXNOdW1iZXIsXG4gIElzT3B0aW9uYWwsXG4gIElzU3RyaW5nLFxuICBNYXRjaGVzLFxuICBWYWxpZGF0ZU5lc3RlZCxcbiAgdmFsaWRhdGVPclJlamVjdCxcbn0gZnJvbSAnY2xhc3MtdmFsaWRhdG9yJztcblxuZXhwb3J0IGNsYXNzIFF1ZXJ5IHtcbiAgQElzU3RyaW5nKClcbiAgQElzT3B0aW9uYWwoKVxuICBzZWxlY3Q6IHN0cmluZztcblxuICBASXNTdHJpbmcoKVxuICBASXNPcHRpb25hbCgpXG4gIGZyb206IHN0cmluZztcblxuICBASXNTdHJpbmcoKVxuICBASXNPcHRpb25hbCgpXG4gIHdoZXJlPzogc3RyaW5nO1xuXG4gIEBJc1N0cmluZygpXG4gIEBJc09wdGlvbmFsKClcbiAgb3JkZXJCeT86IHN0cmluZztcblxuICBjb25zdHJ1Y3RvcihzZWxlY3Q6IHN0cmluZywgZnJvbTogc3RyaW5nLCB3aGVyZT86IHN0cmluZywgb3JkZXJCeT86IHN0cmluZykge1xuICAgIHRoaXMuc2VsZWN0ID0gc2VsZWN0O1xuICAgIHRoaXMuZnJvbSA9IGZyb207XG4gICAgdGhpcy53aGVyZSA9IHdoZXJlO1xuICAgIHRoaXMub3JkZXJCeSA9IG9yZGVyQnk7XG4gIH1cblxuICBnZXRDb3VudFNxbCgpIHtcbiAgICBsZXQgc3FsID0gYFNFTEVDVCBDT1VOVCgqKSBBUyB2YWx1ZSBGUk9NICR7dGhpcy5mcm9tfSBgO1xuICAgIGlmICh0aGlzLndoZXJlKSBzcWwgKz0gYFdIRVJFICR7dGhpcy53aGVyZX0gYDtcbiAgICByZXR1cm4gc3FsO1xuICB9XG5cbiAgZ2V0U3FsKGxpbWl0OiBudW1iZXIsIHBhZ2U6IG51bWJlcikge1xuICAgIGNvbnN0IHNraXAgPSAocGFnZSAtIDEpICogbGltaXQ7XG4gICAgbGV0IHNxbCA9IGBTRUxFQ1QgJHt0aGlzLnNlbGVjdH0gRlJPTSAke3RoaXMuZnJvbX0gYDtcbiAgICBpZiAodGhpcy53aGVyZSkgc3FsICs9IGBXSEVSRSAke3RoaXMud2hlcmV9IGA7XG4gICAgaWYgKHRoaXMub3JkZXJCeSkgc3FsICs9IGBPUkRFUiBCWSAke3RoaXMub3JkZXJCeX0gYDtcbiAgICBzcWwgKz0gYExJTUlUICR7c2tpcH0sICR7bGltaXR9YFxuICAgIHJldHVybiBzcWw7XG4gIH1cbn1cbmV4cG9ydCBjbGFzcyBGaWx0ZXIge1xuICBASXNTdHJpbmcoKVxuICBmaWVsZDogc3RyaW5nO1xuXG4gIEBJc1N0cmluZygpXG4gIEBJc0luKFsnSU4nLCAnTElLRScsICc9JywgJz49JywgJzw9JywgJ05PVCBMSUtFJywgJyE9J10pXG4gIG9wZXJhdG9yOiAnSU4nIHwgJ0xJS0UnIHwgJz0nIHwgJz49JyB8ICc8PScgfCAnTk9UIExJS0UnIHwgJyE9JztcblxuICB2YWx1ZTogYW55O1xuXG4gIGNvbnN0cnVjdG9yKGZpZWxkOiBzdHJpbmcsIG9wZXJhdG9yOiAnSU4nIHwgJ0xJS0UnIHwgJz0nIHwgJz49JyB8ICc8PScgfCAnTk9UIExJS0UnIHwgJyE9JywgdmFsdWU6IGFueSkge1xuICAgIHRoaXMuZmllbGQgPSBmaWVsZDtcbiAgICB0aGlzLm9wZXJhdG9yID0gb3BlcmF0b3I7XG4gICAgdGhpcy52YWx1ZSA9IHZhbHVlO1xuICB9XG59XG5cbmV4cG9ydCBjbGFzcyBHZXRSZXNvdXJjZXNEdG8ge1xuICBASXNBcnJheSgpXG4gIEBJc09wdGlvbmFsKClcbiAgZmllbGRzPzogc3RyaW5nW107XG5cbiAgQElzU3RyaW5nKClcbiAgQElzT3B0aW9uYWwoKVxuICBATWF0Y2hlcygvXlsrLV0uKi8sIHtcbiAgICBtZXNzYWdlOiBcInNvcnQgbXVzdCBzdGFydCB3aXRoICcrJyBvciAnLSdcIixcbiAgICBlYWNoOiB0cnVlLFxuICB9KVxuICBzb3J0Pzogc3RyaW5nO1xuXG4gIEBJc0FycmF5KClcbiAgQElzT3B0aW9uYWwoKVxuICBAVmFsaWRhdGVOZXN0ZWQoKVxuICBAVHlwZSgoKSA9PiBGaWx0ZXIpXG4gIGZpbHRlcnM/OiBGaWx0ZXJbXTtcblxuICBASXNOdW1iZXIoKVxuICBASXNPcHRpb25hbCgpXG4gIGxpbWl0PzogbnVtYmVyO1xuXG4gIEBJc051bWJlcigpXG4gIEBJc09wdGlvbmFsKClcbiAgcGFnZT86IG51bWJlcjtcblxuICBASXNPcHRpb25hbCgpXG4gIEBWYWxpZGF0ZU5lc3RlZCgpXG4gIEBUeXBlKCgpID0+IFF1ZXJ5KVxuICBxdWVyeT86IFF1ZXJ5O1xuXG4gIGNvbnN0cnVjdG9yKCkge1xuICAgIHRoaXMuZmlsdGVycyA9IFtdO1xuICAgIHRoaXMubGltaXQgPSAxMDtcbiAgICB0aGlzLnBhZ2UgPSAxO1xuICB9XG5cbiAgdG9QYXJhbXNEaWN0KCkge1xuICAgIGNvbnN0IGRpY3Q6IHsgW2tleTogc3RyaW5nXSA6IGFueSB9ID0ge307XG4gICAgaWYgKHRoaXMuZmllbGRzKSBkaWN0WydmaWVsZHMnXSA9IEpTT04uc3RyaW5naWZ5KHRoaXMuZmllbGRzKTtcbiAgICBpZiAodGhpcy5zb3J0KSBkaWN0Wydzb3J0J10gPSBKU09OLnN0cmluZ2lmeSh0aGlzLnNvcnQpO1xuICAgIGlmICh0aGlzLmZpbHRlcnMpIGRpY3RbJ2ZpbHRlcnMnXSA9IEpTT04uc3RyaW5naWZ5KHRoaXMuZmlsdGVycyk7XG4gICAgaWYgKHRoaXMuc29ydCkgZGljdFsnc29ydCddID0gSlNPTi5zdHJpbmdpZnkodGhpcy5zb3J0KTtcbiAgICBpZiAodGhpcy5wYWdlKSBkaWN0WydwYWdlJ10gPSBKU09OLnN0cmluZ2lmeSh0aGlzLnBhZ2UpO1xuICAgIGlmICh0aGlzLnF1ZXJ5KSBkaWN0WydxdWVyeSddID0gSlNPTi5zdHJpbmdpZnkodGhpcy5xdWVyeSk7XG4gICAgaWYgKHRoaXMubGltaXQpIGRpY3RbJ2xpbWl0J10gPSBKU09OLnN0cmluZ2lmeSh0aGlzLmxpbWl0KTtcbiAgICByZXR1cm4gZGljdDtcbiAgfVxuXG4gIGZyb21QYXJhbXNEaWN0KHBhcmFtczogYW55KSB7XG4gICAgY29uc3QgeyBmaWVsZHMsIHNvcnQsIGZpbHRlcnMsIGxpbWl0LCBwYWdlLCBxdWVyeSB9ID0gcGFyYW1zO1xuICAgIGlmIChmaWVsZHMpIHRoaXMuZmllbGRzID0gSlNPTi5wYXJzZShmaWVsZHMpO1xuICAgIGlmIChzb3J0KSB0aGlzLnNvcnQgPSBKU09OLnBhcnNlKHNvcnQpO1xuICAgIGlmIChmaWx0ZXJzKSB0aGlzLmZpbHRlcnMgPSBKU09OLnBhcnNlKGZpbHRlcnMpO1xuICAgIGlmIChsaW1pdCkgdGhpcy5saW1pdCA9IEpTT04ucGFyc2UobGltaXQpO1xuICAgIGlmIChwYWdlKSB0aGlzLnBhZ2UgPSBKU09OLnBhcnNlKHBhZ2UpO1xuICAgIGlmIChxdWVyeSkge1xuICAgICAgY29uc3QgcXVlcnlEaWN0ID0gSlNPTi5wYXJzZShxdWVyeSk7XG4gICAgICB0aGlzLnF1ZXJ5ID0gbmV3IFF1ZXJ5KFxuICAgICAgICBxdWVyeURpY3Quc2VsZWN0LFxuICAgICAgICBxdWVyeURpY3QuZnJvbSxcbiAgICAgICAgcXVlcnlEaWN0LndoZXJlLFxuICAgICAgICBxdWVyeURpY3Qub3JkZXJCeSxcbiAgICAgIClcbiAgICB9XG4gIH1cblxuICBhc3luYyB2YWxpZGF0ZSgpIHtcbiAgICB0cnkge1xuICAgICAgYXdhaXQgdmFsaWRhdGVPclJlamVjdCh0aGlzKTtcbiAgICAgIHJldHVybiB0cnVlO1xuICAgIH0gY2F0Y2ggKGVycm9ycykge1xuICAgICAgY29uc29sZS5sb2coJ0R0byBWYWxpZGF0aW9uIEZhaWxlZC4gRXJyb3JzOiAnLCBlcnJvcnMpO1xuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgfVxufVxuIl19